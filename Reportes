SELECT 
    [3_numeroOrdencompra] AS numeroOrden,
    [3_numeroIngreso] AS ingreso,
    CASE 
        WHEN [3_numeroIngreso] = 'Parcial' OR [3_numeroIngreso] = '' OR [3_numeroIngreso] IS NULL THEN 'Parcial'
        ELSE 'Completo'
    END AS estadoIngreso
FROM Panel_109_68508;


SELECT 
    ID,
    [3_numeroOrdencompra] AS numeroOrden,
    [3_fechaOC] AS fechaOC,
    [3_numfacturapro] AS factura,
    [3_numeroIngreso] AS ingreso,
    [3_Pagos] AS idPago
FROM Panel_109_68508
WHERE [3_numeroOrdencompra] IS NOT NULL;


SELECT ID, IdTermino, Opcion
FROM AP__Diccionario_Terminos_Opciones
WHERE IdTermino = '736';



SELECT 
    [3_numeroOrdencompra] AS numeroOrden,
    [3_numeroIngreso] AS ingreso
FROM Panel_109_68508
WHERE [3_numeroIngreso] = 'Parcial'
   OR [3_numeroIngreso] = ''
   OR [3_numeroIngreso] IS NULL;



SELECT 
    GC_PM.[3_numeroOrdencompra] AS numeroOrden,
    ISNULL(OPC_TI.Opcion, '') AS tipoIngreso,
    GC_PM.[3_numeroIngreso] AS ingreso
FROM Panel_109_68508 GC_PM
LEFT JOIN AP__Diccionario_Terminos_Opciones OPC_TI
    ON OPC_TI.ID = GC_PM.[3_Pagos] AND OPC_TI.IdTermino = '736'
WHERE [3_numeroOrdencompra] IS NOT NULL
  AND (OPC_TI.Opcion = 'Parcial' 
       OR (OPC_TI.Opcion = 'Completo' 
           AND GC_PM.[3_numfacturapro] <> '' 
           AND GC_PM.[3_numfacturapro] IS NOT NULL))
  AND (GC_PM.[3_numeroIngreso] = 'Parcial' 
       OR GC_PM.[3_numeroIngreso] = '' 
       OR GC_PM.[3_numeroIngreso] IS NULL);








