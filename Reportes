for (const nova of novas) {
  if (restante <= 0) break;

  const cantidadNova = Number(nova.cantidad || 0);
  if (cantidadNova <= 0) continue;

  const yaIngresado = mapIngresado.get(codigoAura) || 0;

  const CantidadI = Number(aura.CantidadI || 0);  // Cantidad ya ingresada
  const CantidadR = Number(aura.CantidadR || 0);  // Cantidad recibida ahora
  const CantidadT = Number(aura.CantidadT || 0);  // Cantidad total

  // ðŸ”¹ Primera suma: actualizar CantidadI con la cantidad recibida
  const CantidadIActualizada = CantidadI + CantidadR;

  // ðŸ”¹ Resta final: calcular pendiente con el resultado de la suma
  const CantidadPendiente = CantidadT - CantidadIActualizada;

  console.log('===== DEBUG SUMA Y RESTA PARCIAL =====');
  console.log({
    item: aura.codItem,
    CantidadT,
    CantidadI,
    CantidadR,
    CantidadIActualizada,
    CantidadPendiente
  });

  // Si no hay pendiente, continuar
  if (CantidadPendiente <= 0) continue;

  // ValidaciÃ³n adicional con ERP
  const pendienteRealERP = CantidadPendiente - yaIngresado;
  if (pendienteRealERP <= 0) continue;

  // Determinar la cantidad a insertar
  const cantidadInsertar = Math.min(
    restante,
    cantidadNova,
    pendienteRealERP
  );

  if (cantidadInsertar <= 0) continue;

  // ðŸ”¹ AquÃ­ se harÃ­a el INSERT con cantidadInsertar
  await this.prismaNovasoftService.$executeRawUnsafe(`
    INSERT INTO inv_inf_inv (
      ...,
      cantidad,
      ...
    )
    VALUES (
      ...,
      '${cantidadInsertar}',
      ...
    );
  `);

  restante -= cantidadInsertar;
}