SELECT  
    GC_PM.[3_numeroOrdencompra] AS numeroOrden,
    GC_PM.ID,
    CASE 
        WHEN ENL_TS.IdElementoEnlazado = 9764 THEN 'S'
        WHEN ENL_TS.IdElementoEnlazado = 9765 THEN 'P'
        WHEN ENL_TS.IdElementoEnlazado = 9766 THEN 'B'
        WHEN ENL_TS.IdElementoEnlazado = 12144 THEN 'NC'
        WHEN ENL_TS.IdElementoEnlazado = 12166 THEN 'T'
        ELSE 'C'
    END AS tipo,
    GC_PM.[3_numeroIngreso] AS ingreso,
    CASE 
        WHEN GC_PM.[3_numeroIngreso] = 'Parcial' 
             OR GC_PM.[3_numeroIngreso] = '' 
             OR GC_PM.[3_numeroIngreso] IS NULL
        THEN 'Parcial'
        ELSE 'Completo'
    END AS estadoIngreso
FROM Panel_109_68508 GC_PM
LEFT JOIN Panel_109 PA ON PA.ID = GC_PM._ElementID
LEFT JOIN AP__BPM_Procesos P ON P.ID = PA._ElementID
LEFT JOIN AP__Enlaces ENL_TS ON ENL_TS.IdElementoOrigen = P.ID AND ENL_TS.IdTipoEnlace = 69170;