private async findCodSuc(cod_suc: string) {
    if (!cod_suc) {
        throw new BadRequestException('El código de sucursal es obligatorio');
    }

    const result = await this.prismaService.$queryRaw<any[]>(
        `SELECT usr_sucursal FROM gen_clasif1 WHERE codigo = $1`,
        cod_suc
    );

    if (!result.length) {
        throw new BadRequestException(`No se encontró cod_suc para el código ${cod_suc}`);
    }

    return result[0].usr_sucursal;
}



const sucursal = await this.findCodSuc(data.cod_suc);