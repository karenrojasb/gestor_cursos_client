// Buscar cod_suc en la tabla gen_clasif1 y obtener usr_sucursal
const sucursalInfo = await this.prismaService.$queryRawUnsafe<any[]>(`
    SELECT usr_sucursal 
    FROM gen_clasif1 
    WHERE codigo = '${data.cod_suc}'
`);

if (sucursalInfo.length === 0) {
    throw new BadRequestException(`El código de sucursal ${data.cod_suc} no existe`);
}

const cod_suc = sucursalInfo[0].usr_sucursal; // ✅ Este es el valor real que se sube al insert


const cod_suc = await this.findCodSuc(data.cod_suc);



private async findCodSuc(codigo: string): Promise<string> {
    const result = await this.prismaService.$queryRaw<any[]>(
        `SELECT usr_sucursal FROM gen_clasif1 WHERE codigo = ?`, codigo
    );
    if (result.length === 0) {
        throw new BadRequestException(`El código ${codigo} no existe en gen_clasif1`);
    }
    return result[0].usr_sucursal;
}